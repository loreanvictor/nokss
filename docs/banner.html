<div id="banner" role="none"></div>

<style>
  #banner {
    backface-visibility: hidden;
    will-change: transform;
    line-height: 12px;
    position: absolute;
    max-width: var(--main-content-max-width);
    height: calc(var(--main-content-max-width) * 2/3);
    top: calc(var(--spacing) * 4);
    opacity: calc(max(var(--border-expression), 0.1));
    z-index: 0;
    overflow: hidden;
  }

  @media (prefers-color-scheme: dark) {
    #banner {
      opacity: calc(max(var(--border-expression), 0.05) * 3);
    }
  }

  #banner .dot {
    width: 32px;
    height: 32px;
    background: var(--background-color);
    border: 1px solid var(--text-color);
    margin: 0;
    border-radius: 0px;
    display: inline-block;
    animation-name: dotrotation;
    animation-duration: 24s;
    animation-iteration-count: infinite;
    animation-delay: 10s;
    opacity: 0;

    transition: opacity 1s;
  }

  @keyframes dotrotation {
    0% { transform: translateY(0px) scale(1); }
    2.5% { transform: translateY(-32px) scale(1.2); }
    5% { transform: translateY(0px) scale(1); }
    10% { transform: translateY(0px) scale(1); }
    12.5% { transform: translateY(-32px) scale(1.2); }
    15% { transform: translateY(-16px) scale(1.1); }
    17.5% { transform: translateY(-32px) scale(1.2); }
    20% { transform: translateY(0px) scale(1); }
    25% { transform: translateY(0px) scale(1); }
    27.5% { transform: translateY(-18px) scale(1.15); }
    30% { transform: translateY(0px) scale(1); }
    35% { transform: translateY(0px) scale(1); transform-origin: center; }
    37.5% { transform: rotate(0deg) scale(1.2); transform-origin: 0px 36px; }
    50% { transform: rotate(180deg) scale(1); transform-origin: center; }
    52.5% { transform: translateY(-16px) scale(1.2); }
    55% { transform: translateY(0px) scale(1); tranform-origin: center; }
    60% { transform: translateY(0px) scale(1); tranform-origin: center; }
    65% { transform: rotate(0deg) scale(1.2); transform-origin: 0px 36px; }
    80% { transform: rotate(-180deg) scale(1); transform-origin: center; }
    85% { transform: translateY(0px) scale(1); }
    87.5% { transform: translateY(-32px) scale(1.2); }
    90% { transform: translateY(-16px) scale(1.1); }
    92.5% { transform: translateY(-32px) scale(1.2); }
    100% { transform: translateY(0px) scale(1); }
  }

  p {
    position: relative;
  }
</style>

<script type="module" defer>
import { html } from 'https://esm.sh/rehtm'

const NUM = 400
const host = document.querySelector('#banner')

for (let i = 0; i < NUM; i++) {
  host.append(html`<div class=dot></div>`)
}

setTimeout(() => {
  const width = Math.floor(host.getBoundingClientRect().width / 32)
  const height = Math.floor(host.getBoundingClientRect().height / 64)
  const dist = (x, y) => Math.sqrt((x - width / 2) * (x - width / 2) + (y - height / 2) * (y - height / 2))
  const maxdist = (width/2 + 3 * height/2) / 4

  host.querySelectorAll('.dot').forEach((dot, i) => {
    const x = i % width
    const y = Math.floor(i / width)
    const delay = dist(x, y) * 200 + 3000
    const opacity = 1 - dist(x,y) / maxdist

    dot.style.animationDelay = `${delay}ms`
    dot.style.opacity = opacity
  })
}, 200)

</script>