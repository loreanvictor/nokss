<div id="banner"></div>

<style>
  #banner {
    position: absolute;
    max-width: var(--main-content-max-width);
    height: calc(var(--main-content-max-width) * 2/3);
    top: calc(var(--spacing) * 4);
    opacity: calc(max(var(--border-expression), 0.06) * 2);
    z-index: 0;
    overflow: hidden;
  }

  @media (prefers-color-scheme: dark) {
    #banner {
      opacity: calc(max(var(--border-expression), 0.02) * 6);
    }
  }

  #banner .dot {
    width: 2px;
    height: 2px;
    background: var(--text-color);
    margin: 8px;
    border-radius: 4px;
    display: inline-block;
    animation-name: dotrotation;
    animation-duration: 6s;
    animation-iteration-count: infinite;
  }

  @keyframes dotrotation {
    0% {
      transform: translateY(0px) scale(1);
    }
    10% {
      transform: translateY(-18px) scale(2);
    }
    20% {
      transform: translateY(0px) scale(1);
    }
    40% {
      transform: translateY(0px) scale(1);
    }
    50% {
      transform: translateX(-18px) scale(2);
    }
    60% {
      transform: translateX(0px) scale(1.5);
    }
    70% {
      transform: translateX(18px) scale(2);
    }
    80% {
      transform: translateY(0px) scale(1);
    }
    100% {
      transform: translateY(0px) scale(1);
    }
  }

  p {
    position: relative;
  }
</style>

<script type="module" defer>
import { html } from 'https://esm.sh/rehtm'

const NUM = 720

const host = document.querySelector('#banner')

for (let i = 0; i < NUM; i++) {
  host.append(html`<div class=dot></div>`)
}

const width = Math.floor(host.getBoundingClientRect().width / 18)
const height = Math.floor(host.getBoundingClientRect().height / 36)
const dist = (x, y) => Math.sqrt((x - width / 2) * (x - width / 2) + (y - height / 2) * (y - height / 2))
const maxdist = dist(width, height)

host.querySelectorAll('.dot').forEach((dot, i) => {
  const x = i % width
  const y = Math.floor(i / width)
  const delay = dist(x, y) * 200
  const opacity = 1 - dist(x,y) / maxdist

  dot.style.animationDelay = `${delay}ms`
  dot.style.opacity = opacity
})

</script>